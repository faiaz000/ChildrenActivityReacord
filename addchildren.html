<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  


  <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.css">
<script>window.$ = window.jQuery = require('jquery');</script>
  <script src="node_modules/jquery/dist/jquery.js"></script>
  <!---<script src="node_modules/popper.js/dist/popper.js"></script>-->
  <script src="node_modules/bootstrap/dist/js/bootstrap.js"></script> 
  


</head>

<body>
  <h1>CHILDREN ACTIVITY</h1>

  <div class="container">
    <form>
      <div>
        <input id="selecteddate"  type="date">
       
      </div>
      <div id="grade1" class="container">
          <h4>grade1</h4>
        
      </div>
      <div id="grade2" class="container">
          <h4>grade2</h4>
       
      </div>
      <div id="grade3" class="container">
          <h4>grade3</h4>
      </div>
      <div id="grade4" class="container">
          <h4>grade4</h4>
       
      </div>

      
      <div class="container ">

        <h2>Activities</h2>
        <textarea id ="activityarea" style="width: 500px" id="comment" rows="10"></textarea>
      </div>
      
      
      <button id="addtask" type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
          Submit
      </button>
      <div class="modal" id="exampleModal" tabindex="-1" role="dialog">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Confirm Box</h5>
                <button id="dismisstop"type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <h2>Activity</h2>
                <h3 id="dateheader"></h3>
                <h4 id="participants"></h4>
                <p id = "activityparagraph"></p>
              </div>
              <div class="modal-footer">
                  
        
              <button id="confirm" class="btn btn-primary"style="float: right" data-dismiss="modal" type="submit">Confirm</button>
              
                    
              <button  id ="dismiss"  type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              </div>
            </div>
          </div>

        </div>
    </form>
    
  </div>


  <script>

  
    //window.$ = window.jQuery = require('jquery')
    const electron = require('electron');
   const Activity = require('./Activity');
    var now = new Date();
    console.log(now);
    const { ipcRenderer } = electron
    window.onload = function(){
      //console.log("hello");
      document.getElementById('selecteddate').valueAsDate = now
      ipcRenderer.send('activitywindowloaded')
      
    }
    ipcRenderer.on('hello',(e,childrenlist)=>{
      childrenlist.forEach((child)=>{
        //console.log(child);
        let div = document.getElementById(child.grade)
        div.innerHTML += `<label class="checkbox-inline"><input id="${child.id}" name= "people" type="checkbox" onchange="toggleCheckbox(this,$(this))" value="${child.name}"> ${child.name} </label>`

      })
      
    })

   

    function checkboxToDes(grade,name){
      console.log(grade,name)
    }
    function toggleCheckbox(element,grade)
 {
   console.log("..")
   //console.log(grade.parent().parent().attr('id'))
   console.log("  ")
   if(element.checked===true){
    console.log(element.value,grade)
    document.getElementById('activityarea').value += element.value
   } 
  
 }
 var peoplelist = [];
 document.getElementById('addtask').addEventListener('click',()=>{
  var selecteddate = document.getElementById('selecteddate').value
  console.log("hello " + selecteddate);
  document.getElementById('dateheader').innerText = selecteddate
  var text=document.getElementById('activityarea').value
  document.getElementById('activityparagraph').innerText =text
  $.each($("input[name='people']:checked"), function() {
   peoplelist.push($(this))
   document.getElementById('participants').innerText += ' ' + $(this).val();
   
  });
 })

 document.getElementById('dismiss').addEventListener('click',()=>{
  document.getElementById('participants').innerText = ""
  peoplelist = [];
 })
 document.getElementById('dismisstop').addEventListener('click',()=>{
  document.getElementById('participants').innerText = ""
  peoplelist = [];
 })

 document.getElementById('confirm').addEventListener('click',(e)=>{
  e.preventDefault() ;
  var selecteddate= document.getElementById('selecteddate').value
  peoplelist.forEach((person)=>{
    //console.log("Person is : " + person.attr('value'))
    
    var student = person.attr('value')
    var id = person.attr('id')
   // console.log("grade is : "+ person.parent().parent().attr('id'));
    //var grade = person.parent().parent().attr('id');
    var description = document.getElementById('activityarea').value
    var dateval = now
    var activity = new Activity(description,dateval,id)
    ipcRenderer.send('addactivity',activity);
    
  })
  peoplelist = [];
  $('input[type=checkbox]').each(function() 
  { 
          this.checked = false; 
  }); 
  document.getElementById('participants').innerText = ""
  //console.log(activity.date)
  //ipcRenderer.send('addactivity','hello');
 })

  </script>

</body>

</html>